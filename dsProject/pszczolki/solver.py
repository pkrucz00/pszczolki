import numpy as np

def cost_function(A: np.ndarray, P: np.ndarray, gamma: np.ndarray, ns: np.ndarray, ) -> float:
